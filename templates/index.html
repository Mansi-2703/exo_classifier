<!DOCTYPE html>
<html lang="en" style="scroll-behavior: smooth;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exo-Detect | Find New Worlds</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script>
    <style>
        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: #0a0a1a;
            color: #e0e0e0;
            background-image: linear-gradient(rgba(10, 10, 26, 0.85), rgba(10, 10, 26, 0.95)), url('https://images.unsplash.com/photo-1462331940025-496dfbfc7564?q=80&w=2111&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        .section-fade-in { opacity: 0; transform: translateY(30px); transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
        .section-fade-in.visible { opacity: 1; transform: translateY(0); }
        .btn { transition: all 0.3s ease; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); }
        .card { background-color: rgba(26, 26, 58, 0.7); backdrop-filter: blur(10px); border: 1px solid #2a2a4a; transition: all 0.3s ease; }
        .card:hover { transform: translateY(-5px); border-color: #4f46e5; }
        
        .plot-container { display: flex; flex-direction: column; background-color: rgba(26, 26, 58, 0.7); backdrop-filter: blur(10px); border: 1px solid #2a2a4a; border-radius: 0.5rem; padding: 1.5rem; min-height: 480px; }
        .chart-area { flex-grow: 1; min-height: 0; }
        
        #drop-zone { border: 2px dashed #3a3a5a; transition: all 0.3s ease; }
        #drop-zone.dragover { background-color: #1a1a3a; border-color: #4f46e5; }
        
        .loader { border: 4px solid #3a3a5a; border-top: 4px solid #4f46e5; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .loading-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(5px); z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: all 0.3s ease; }
        .loading-overlay.visible { opacity: 1; visibility: visible; }

        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(5px); z-index: 1000; display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: all 0.3s ease; }
        .modal-overlay.visible { opacity: 1; visibility: visible; }
        .modal-content { background-color: #1a1a3a; border: 1px solid #2a2a4a; border-radius: 0.5rem; padding: 2rem; width: 90%; max-width: 900px; max-height: 80vh; overflow-y: auto; transform: scale(0.95); transition: all 0.3s ease; }
        .modal-overlay.visible .modal-content { transform: scale(1); }
        .modal-table { width: 100%; border-collapse: collapse; }
        .modal-table th, .modal-table td { padding: 0.75rem; text-align: left; border-bottom: 1px solid #2a2a4a; font-size: 0.875rem; }
        .modal-table th { font-weight: bold; color: #a5b4fc; }
        .modal-table td { color: #e0e0e0; }
    </style>
</head>
<body class="antialiased">

    <!-- Section 1: Hero -->
    <section id="hero" class="min-h-screen flex flex-col items-center justify-center text-center p-6">
        <div class="section-fade-in visible">
            <h1 class="text-5xl md:text-8xl font-bold text-white mb-4 tracking-tighter">Exo-Detect</h1>
            <p class="text-lg md:text-2xl text-gray-300 mb-8 max-w-2xl">An interactive dashboard for exoplanet habitability analysis, powered by machine learning insights.</p>
            <a href="#data-section" class="btn bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg">Get Started</a>
        </div>
    </section>

    <!-- Section 2: Data Input -->
    <section id="data-section" class="min-h-screen container mx-auto px-6 py-20 flex flex-col items-center justify-center">
        <div class="section-fade-in w-full">
            <h2 class="text-4xl font-bold text-center mb-2">Choose Your Data Source</h2>
            <p class="text-center text-gray-400 mb-12">Upload your own dataset or use our sample to see the model in action.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-10 max-w-4xl mx-auto">
                <div class="card p-8 rounded-lg text-center flex flex-col">
                    <h3 class="text-2xl font-bold mb-4 text-white">Upload Your CSV</h3>
                    <p class="text-gray-400 mb-6">Provide a dataset in CSV format. The backend server will analyze it with the trained model.</p>
                    <div id="drop-zone" class="p-10 rounded-lg cursor-pointer flex-grow flex flex-col justify-center">
                        <input type="file" id="file-input" class="hidden" accept=".csv">
                        <p id="drop-zone-text" class="text-gray-400">Drag & drop your file here or click to select</p>
                        <div id="file-info" class="hidden items-center justify-center">
                            <span id="file-name" class="text-indigo-400 font-semibold"></span>
                            <button id="remove-file-button" class="ml-3 text-red-500 hover:text-red-400">&times;</button>
                        </div>
                    </div>
                    <button id="upload-button" class="btn bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-8 rounded-full mt-6 w-full">Select File & Analyze</button>
                </div>
                <div class="card p-8 rounded-lg text-center flex flex-col">
                    <h3 class="text-2xl font-bold mb-4 text-white">Try Sample Data</h3>
                    <p class="text-gray-400 mb-6">Don't have a file? Use our pre-loaded Kepler dataset to see how the analysis works instantly.</p>
                    <div class="bg-black/20 p-10 rounded-lg flex items-center justify-center h-full flex-grow">
                         <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-database-check text-indigo-400" viewBox="0 0 16 16"><path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514M8 1c-1.573 0-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4s.875 1.755 1.904 2.223C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777C13.125 5.755 14 5.007 14 4s-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1"/><path d="M2 7v-.839c.457.432 1.004.751 1.49.972C4.722 7.693 6.318 8 8 8s3.278-.307 4.51-.867c.486-.22 1.033-.54 1.49-.972V7c0 .424-.155.802-.411 1.133a4.51 4.51 0 0 0-4.815 1.843A12 12 0 0 1 8 10c-1.573 0-3.022-.289-4.096-.777C2.875 8.755 2 8.007 2 7m6.257 3.998L8 11c-1.682 0-3.278-.307-4.51-.867-.486-.22-1.033-.54-1.49-.972V10c0 1.007.875 1.755 1.904 2.223C4.978 12.711 6.427 13 8 13h.027a4.55 4.55 0 0 1 .23-2.002"/></svg>
                    </div>
                    <div class="mt-6 space-y-3">
                         <button id="start-sample-button" class="btn bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-full w-full">Analyze Sample Data</button>
                         <button id="view-data-button" class="text-indigo-400 hover:text-indigo-300 text-sm font-semibold">View Data</button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Loading Overlay -->
    <div id="loading-section" class="loading-overlay">
         <div class="loader"></div>
         <p id="loading-text" class="text-xl text-gray-400 mt-6"></p>
    </div>

    <!-- Results Dashboard Section -->
    <section id="results-section" class="hidden container mx-auto px-6 py-20">
        <div class="section-fade-in w-full max-w-7xl mx-auto">
            <h2 class="text-4xl font-bold text-center mb-12">Exoplanet Analysis Dashboard</h2>
            
            <!-- Analysis Summary Card - UPDATED -->
            <div id="summary-card" class="card p-6 rounded-lg mb-8">
                <h3 class="text-2xl font-bold mb-4 text-white">Analysis Summary</h3>
                <div class="grid md:grid-cols-3 gap-6 text-center">
                    <div>
                        <p id="rows-processed" class="text-4xl md:text-5xl font-bold text-indigo-400">0</p>
                        <p class="text-gray-400">Total Planets</p>
                    </div>
                    <div>
                        <p id="candidates-found" class="text-4xl md:text-5xl font-bold text-yellow-400">0</p>
                        <p class="text-gray-400">Candidates Found</p>
                    </div>
                    <div>
                        <p id="habitable-found" class="text-4xl md:text-5xl font-bold text-green-400">0</p>
                        <p class="text-gray-400">Potentially Habitable</p>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="plot-container lg:col-span-2"><h3 class="text-xl font-bold mb-1 text-white">1. Goldilocks Zone Plot</h3><p class="text-sm text-gray-400 mb-4">Shows if a planet is in the habitable zone where liquid water could exist. Green = habitable, Yellow = candidate but not habitable, Red = not a candidate.</p><div id="goldilocks-plot" class="chart-area"></div></div>
                <div class="plot-container"><h3 class="text-xl font-bold mb-1 text-white">2. Orbit Map</h3><p class="text-sm text-gray-400 mb-4">Visualizes planets' orbits around their star. Distance from center is based on orbital period.</p><div id="orbit-plot" class="chart-area"></div></div>
                <div class="plot-container"><h3 class="text-xl font-bold mb-1 text-white">3. Feature Importance</h3><p class="text-sm text-gray-400 mb-4">Reveals which factors the model considers most important for predicting habitability. (Illustrative)</p><div id="feature-importance-plot" class="chart-area"></div></div>
                <div class="plot-container"><h3 class="text-xl font-bold mb-1 text-white">4. Planetary Profile (Radar Chart)</h3><p class="text-sm text-gray-400 mb-4">Compares a candidate planet's key features to Earth's profile. (Illustrative comparison)</p><div id="radar-plot" class="chart-area"></div></div>
                <div class="plot-container"><h3 class="text-xl font-bold mb-1 text-white">5. Prediction Explainability (SHAP)</h3><p class="text-sm text-gray-400 mb-4">Explains *why* the model made a specific prediction for a sample planet. (Illustrative)</p><div id="shap-plot" class="chart-area"></div></div>
                <div class="plot-container lg:col-span-2"><h3 class="text-xl font-bold mb-1 text-white">6. Bonus: Galactic Map</h3><p class="text-sm text-gray-400 mb-4">Plots the position of the exoplanets in the sky based on their celestial coordinates (Right Ascension & Declination).</p><div id="galactic-map-plot" class="chart-area"></div></div>
                <div class="plot-container lg:col-span-2"><h3 class="text-xl font-bold mb-1 text-white">7. Feature Pair Explorer</h3><p class="text-sm text-gray-400 mb-4">Select any two features from the dataset to create a custom scatter plot and discover relationships.</p><div class="flex flex-wrap gap-4 mb-4"><div class="flex-grow"><label for="x-axis-select" class="block text-sm font-medium text-gray-300">X-Axis</label><select id="x-axis-select" class="mt-1 block w-full bg-gray-800 border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"></select></div><div class="flex-grow"><label for="y-axis-select" class="block text-sm font-medium text-gray-300">Y-Axis</label><select id="y-axis-select" class="mt-1 block w-full bg-gray-800 border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"></select></div><button id="plot-explorer-button" class="btn bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-6 rounded-md self-end">Plot</button></div><div id="explorer-plot" class="chart-area"></div></div>
            </div>
        </div>
    </section>

    <!-- Data Viewer Modal -->
    <div id="data-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-bold text-white">Sample Data Preview</h3>
                <button id="modal-close-button" class="text-gray-400 hover:text-white text-3xl">&times;</button>
            </div>
            <div id="modal-table-container" class="overflow-x-auto">
                <p class="text-gray-400">Loading data...</p>
            </div>
        </div>
    </div>

    <footer class="text-center py-6 border-t border-[#2a2a4a]/70 mt-12">
        <p class="text-gray-500">Built by a student exploring the cosmos with code.</p>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        let fullDataset = [];
        const API_URL = 'http://127.0.0.1:5000';
        const plotlyLayoutConfig = { paper_bgcolor: 'rgba(0,0,0,0)', plot_bgcolor: 'rgba(0,0,0,0)', font: { color: '#e0e0e0', family: 'Space Grotesk' }, margin: { l: 60, r: 30, t: 70, b: 60 }, xaxis: { gridcolor: 'rgba(255,255,255,0.1)', linecolor: 'rgba(255,255,255,0.2)', zerolinecolor: 'rgba(255,255,255,0.2)' }, yaxis: { gridcolor: 'rgba(255,255,255,0.1)', linecolor: 'rgba(255,255,255,0.2)', zerolinecolor: 'rgba(255,255,255,0.2)' }, legend: { x: 1, xanchor: 'right', y: 1 }, title: { x: 0.05, xanchor: 'left', pad: { t: 20 } } };

        const observer = new IntersectionObserver((entries) => entries.forEach(entry => entry.isIntersecting && entry.target.classList.add('visible')), { threshold: 0.1 });
        document.querySelectorAll('.section-fade-in').forEach(el => observer.observe(el));
        
        const dashboard = document.getElementById('results-section');
        const resizeObserver = new ResizeObserver(() => {
            dashboard.querySelectorAll('.chart-area').forEach(chartDiv => {
                if(chartDiv.classList.contains('js-plotly-plot')) Plotly.Plots.resize(chartDiv);
            });
        });
        resizeObserver.observe(dashboard);

        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const uploadButton = document.getElementById('upload-button');
        const startSampleButton = document.getElementById('start-sample-button');
        
        dropZone.addEventListener('click', () => fileInput.click());
        uploadButton.addEventListener('click', () => fileInput.files.length > 0 ? handleFile(fileInput.files[0]) : fileInput.click());
        fileInput.addEventListener('change', () => fileInput.files.length > 0 && handleFile(fileInput.files[0]));
        dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.classList.add('dragover'); });
        dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));
        dropZone.addEventListener('drop', (e) => { e.preventDefault(); dropZone.classList.remove('dragover'); e.dataTransfer.files.length > 0 && handleFile(e.dataTransfer.files[0]); });
        
        function handleFile(file) {
            if (!file.name.endsWith('.csv')) { alert("Please upload a valid CSV file."); return; }
            document.getElementById('file-name').textContent = file.name;
            document.getElementById('drop-zone-text').classList.add('hidden');
            document.getElementById('file-info').classList.remove('hidden');
            startAnalysis({file: file, type: 'upload'});
        }

        startSampleButton.addEventListener('click', () => startAnalysis({type: 'sample'}));
        
        async function startAnalysis(config) {
            const loadingOverlay = document.getElementById('loading-section');
            const loadingText = document.getElementById('loading-text');
            loadingText.textContent = 'Contacting server and waiting for model prediction...';
            loadingOverlay.classList.add('visible');
            document.getElementById('results-section').classList.add('hidden');
            
            const endpoint = config.type === 'sample' ? `${API_URL}/predict_sample` : `${API_URL}/predict`;
            const fetchOptions = config.type === 'sample' ? { method: 'GET' } : { method: 'POST', body: (() => { const fd = new FormData(); fd.append('file', config.file); return fd; })() };

            try {
                const response = await fetch(endpoint, fetchOptions);
                if (!response.ok) { const errorData = await response.json(); throw new Error(errorData.error || `HTTP error! status: ${response.status}`); }
                loadingText.textContent = 'Predictions received. Rendering visualizations...';
                
                const jsonString = await response.json();
                fullDataset = JSON.parse(jsonString);
                
                // UPDATED: Extract habitable count
                const candidatesCount = fullDataset.filter(p => p.disposition === 1).length;
                const habitableCount = fullDataset.filter(p => p.habitable === 1).length;
                
                document.getElementById('rows-processed').textContent = fullDataset.length;
                document.getElementById('candidates-found').textContent = candidatesCount;
                document.getElementById('habitable-found').textContent = habitableCount;

                const headers = Object.keys(fullDataset[0]);
                populateExplorerDropdowns(headers);
                renderAllVisualizations(fullDataset);

                loadingOverlay.classList.remove('visible');
                document.getElementById('results-section').classList.remove('hidden');
                document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                loadingOverlay.classList.remove('visible');
                alert(`Analysis Failed: ${error.message}\n\nIs the Python backend server running? (Check the README)`);
                console.error("Fetch Error:", error);
            }
        }
        
        const modal = document.getElementById('data-modal');
        const viewDataButton = document.getElementById('view-data-button');
        const closeModalButton = document.getElementById('modal-close-button');
        const modalTableContainer = document.getElementById('modal-table-container');

        viewDataButton.addEventListener('click', async () => {
            modal.classList.add('visible');
            modalTableContainer.innerHTML = '<p class="text-gray-400">Fetching data from server...</p>';
            try {
                const response = await fetch(`${API_URL}/sample_data`);
                if (!response.ok) throw new Error('Could not fetch sample data.');
                const data = await response.json();
                
                const headers = data.columns;
                const rows = data.data;
                let tableHTML = '<table class="modal-table"><thead><tr>';
                headers.forEach(h => tableHTML += `<th>${h}</th>`);
                tableHTML += '</tr></thead><tbody>';
                rows.forEach(row => {
                    tableHTML += '<tr>';
                    row.forEach(cell => tableHTML += `<td>${cell}</td>`);
                    tableHTML += '</tr>';
                });
                tableHTML += '</tbody></table>';
                modalTableContainer.innerHTML = tableHTML;
            } catch (error) {
                modalTableContainer.innerHTML = `<p class="text-red-400">Error: ${error.message}</p>`;
            }
        });

        const closeModal = () => modal.classList.remove('visible');
        closeModalButton.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });

        function renderAllVisualizations(data) { renderGoldilocksPlot(data); renderOrbitPlot(data); renderFeatureImportancePlot(); renderRadarPlot(); renderShapPlot(); renderGalacticMapPlot(data); }
        
        // UPDATED: New Goldilocks plot with 3 categories
        function renderGoldilocksPlot(data) { 
            const habitable = data.filter(p => p.habitable === 1);
            const candidateNotHabitable = data.filter(p => p.disposition === 1 && p.habitable === 0);
            const notCandidate = data.filter(p => p.disposition === 0);
            
            const t1 = {
                x: habitable.map(p => p.stellar_effective_temperature_k),
                y: habitable.map(p => p.insolation_flux_earth_flux),
                mode: 'markers',
                name: 'Habitable',
                marker: { color: '#22c55e', size: 8, opacity: 0.8, line: { width: 1, color: 'white' } }
            };
            
            const t2 = {
                x: candidateNotHabitable.map(p => p.stellar_effective_temperature_k),
                y: candidateNotHabitable.map(p => p.insolation_flux_earth_flux),
                mode: 'markers',
                name: 'Candidate (Not Habitable)',
                marker: { color: '#eab308', size: 6, opacity: 0.7 }
            };
            
            const t3 = {
                x: notCandidate.map(p => p.stellar_effective_temperature_k),
                y: notCandidate.map(p => p.insolation_flux_earth_flux),
                mode: 'markers',
                name: 'Not a Candidate',
                marker: { color: '#ef4444', size: 4, opacity: 0.5 }
            };
            
            const layout = {
                ...plotlyLayoutConfig,
                title: { ...plotlyLayoutConfig.title, text: 'Goldilocks Zone: Habitability Analysis' },
                xaxis: { ...plotlyLayoutConfig.xaxis, title: 'Stellar Effective Temperature (K)' },
                yaxis: { ...plotlyLayoutConfig.yaxis, title: 'Insolation Flux (Earth Units)', type: 'log' },
                shapes: [{
                    type: 'rect',
                    xref: 'x',
                    yref: 'y',
                    x0: 3000,
                    x1: 7000,
                    y0: 0.32,
                    y1: 1.77,
                    fillcolor: 'rgba(34,197,94,0.15)',
                    line: { width: 2, color: 'rgba(34,197,94,0.5)', dash: 'dash' }
                }],
                annotations: [{
                    x: 5000,
                    y: 1,
                    text: 'Goldilocks Zone',
                    showarrow: false,
                    font: { color: '#22c55e', size: 14 }
                }]
            };
            
            Plotly.newPlot('goldilocks-plot', [t1, t2, t3], layout, { responsive: true });
        }
        
        // UPDATED: Orbit plot with 3 colors
        function renderOrbitPlot(data) { 
            const s=data.slice(0,20), t={r:s.map(p=>p.orbital_period_days),theta:Array.from({length:20},(_,i)=>i*(360/20)),mode:'markers',marker:{color:s.map(p=>p.habitable===1?'#22c55e':(p.disposition===1?'#eab308':'#ef4444')),size:s.map(p=>Math.max(p.planetary_radius_earth_radii,3)*2),opacity:0.8,line:{color:'white',width:1}},type:'scatterpolar'}; const l={...plotlyLayoutConfig,title:{...plotlyLayoutConfig.title,text:'Planet Orbits (sized by radius)'},polar:{bgcolor:'rgba(0,0,0,0)',angularaxis:{visible:false},radialaxis:{gridcolor:'rgba(255,255,255,0.1)'}}}; Plotly.newPlot('orbit-plot',[t],l,{responsive: true});
        }
        
        function renderFeatureImportancePlot() { const f=['Insolation Flux','Planetary Radius','Transit Depth','Stellar Temp','Orbital Period'], i=[0.45,0.25,0.15,0.10,0.05]; const t={y:f,x:i,type:'bar',orientation:'h',marker:{color:'#4f46e5'}}; const l={...plotlyLayoutConfig,title:{...plotlyLayoutConfig.title,text:'Model Feature Importance'},yaxis:{...plotlyLayoutConfig.yaxis,automargin:true}}; Plotly.newPlot('feature-importance-plot',[t],l,{responsive: true});}
        function renderRadarPlot() { const f=['Radius','Temperature','Insolation','Gravity']; const t1={r:[1,1,1,1],theta:f,name:'Earth',fill:'toself',type:'scatterpolar',marker:{color:'rgba(59,130,246,0.7)'}}, t2={r:[1.8,1.2,1.5,1.3],theta:f,name:'Kepler-186f',fill:'toself',type:'scatterpolar',marker:{color:'rgba(34,197,94,0.7)'}}; const l={...plotlyLayoutConfig,polar:{radialaxis:{visible:true,range:[0,2]},bgcolor:'rgba(0,0,0,0)'},legend:{y:0,x:0.5,xanchor:'center'}}; Plotly.newPlot('radar-plot',[t1,t2],l,{responsive: true});}
        function renderShapPlot() { const f=['Insolation = 1.2','Radius = 1.1','Stellar Temp = 5800K','Transit Depth = low'], v=[0.35,0.25,-0.1,0.15]; const t={y:f,x:v,type:'bar',orientation:'h',marker:{color:v.map(v=>v>0?'#22c55e':'#ef4444')}}; const l={...plotlyLayoutConfig,title:{...plotlyLayoutConfig.title,text:'SHAP values for a "Habitable" Prediction'},yaxis:{...plotlyLayoutConfig.yaxis,automargin:true}}; Plotly.newPlot('shap-plot',[t],l,{responsive: true});}
        function renderGalacticMapPlot(data) { const t={x:data.map(p=>p.right_ascension_decimal_degrees),y:data.map(p=>p.declination_decimal_degrees),mode:'markers',marker:{color:data.map(p=>p.habitable===1?'#22c55e':(p.disposition===1?'#eab308':'#a5b4fc')),size:4,opacity:0.7}}; const l={...plotlyLayoutConfig,title:{...plotlyLayoutConfig.title,text:'Sky Distribution of Planets'},xaxis:{...plotlyLayoutConfig.xaxis,title:'Right Ascension (degrees)'},yaxis:{...plotlyLayoutConfig.yaxis,title:'Declination (degrees)'}}; Plotly.newPlot('galactic-map-plot',[t],l,{responsive: true});}
        const xSelect=document.getElementById('x-axis-select'), ySelect=document.getElementById('y-axis-select'); function populateExplorerDropdowns(fields){xSelect.innerHTML='';ySelect.innerHTML='';fields.forEach(f=>{const r=fullDataset[0]||{};if(typeof r[f]==='number'){const oX=document.createElement('option');oX.value=f;oX.textContent=f;xSelect.appendChild(oX);const oY=document.createElement('option');oY.value=f;oY.textContent=f;ySelect.appendChild(oY)}});xSelect.value='orbital_period_days';ySelect.value='planetary_radius_earth_radii';}
        document.getElementById('plot-explorer-button').addEventListener('click',()=>{const xF=xSelect.value,yF=ySelect.value;const t={x:fullDataset.map(p=>p[xF]),y:fullDataset.map(p=>p[yF]),mode:'markers',marker:{color:fullDataset.map(p=>p.habitable===1?'#22c55e':(p.disposition===1?'#eab308':'#ef4444')),size:5,opacity:0.6}};const l={...plotlyLayoutConfig,title:{...plotlyLayoutConfig.title,text:`${yF} vs. ${xF}`},xaxis:{...plotlyLayoutConfig.xaxis,title:xF},yaxis:{...plotlyLayoutConfig.yaxis,title:yF}};Plotly.newPlot('explorer-plot',[t],l,{responsive: true});});
    });
    </script>
</body>
</html>